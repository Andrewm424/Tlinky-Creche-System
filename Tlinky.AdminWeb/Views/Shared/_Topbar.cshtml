<header class="topbar">
    <!-- ===== Page Title ===== -->
    <div class="title">@ViewData["Title"]</div>

    <!-- ===== Right-side Actions ===== -->
    <div class="actions">
        <!-- 🔔 Notifications -->
        <button class="btn ghost" title="Notifications" onclick="openModalTemplate('notificationsModal')">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none"
                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 viewBox="0 0 24 24">
                <path d="M18 8a6 6 0 0 0-12 0c0 7-3 9-3 9h18s-3-2-3-9" />
                <path d="M13.73 21a2 2 0 0 1-3.46 0" />
            </svg>
        </button>

        <!-- 🚪 Logout -->
        <button class="btn ghost" title="Logout" onclick="openModalTemplate('logoutConfirmModal')">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none"
                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 viewBox="0 0 24 24">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 1 1 2-2h4" />
                <polyline points="16 17 21 12 16 7" />
                <line x1="21" y1="12" x2="9" y2="12" />
            </svg>
        </button>
    </div>
</header>


<!-- ✅ Notifications Modal Template -->
<template id="notificationsModal">
    <h3>System Notifications</h3>
    <p style="color:#6B7280; font-size:14px;">Recent system activities and updates.</p>

    <ul id="notificationList" style="margin-top:10px; list-style:none; padding:0; font-size:14px; color:#374151;">
        <li style="text-align:center; color:#9CA3AF;">Loading...</li>
    </ul>


    <div style="display:flex; justify-content:flex-end; gap:10px; margin-top:12px;">
        <button class="btn" onclick="closeModal()">Close</button>
        <button class="btn primary" onclick="tlinkyToast('Notifications cleared'); closeModal()">Clear All</button>
    </div>
</template>


<!-- ✅ Logout Confirmation Modal -->
<template id="logoutConfirmModal">
    <h3>Confirm Logout</h3>
    <p style="color:#6B7280; font-size:14px;">
        Are you sure you want to log out? Unsaved progress may be lost.
    </p>

    <div style="display:flex; justify-content:flex-end; gap:10px; margin-top:12px;">
        <button class="btn" onclick="closeModal()">Cancel</button>
        <button class="btn danger" onclick="confirmLogout()">Yes, Logout</button>
    </div>
</template>

<script>
    async function loadNotifications() {
        const res = await fetch('/api/NotificationsApi');
        const data = await res.json();

        const list = document.getElementById('notificationList');
        list.innerHTML = '';

        if (!data.length) {
            list.innerHTML = '<li style="text-align:center; color:#9CA3AF;">No notifications yet.</li>';
            return;
        }

        data.forEach(n => {
            const icon = n.type === 'Payment' ? '💳' :
                         n.type === 'Incident' ? '⚠️' : '🗒️';
            const date = new Date(n.dateCreated).toLocaleDateString();
            list.innerHTML += `
                <li style="padding:8px 0; border-bottom:1px solid #E5E7EB;">
                    ${icon} <strong>${n.type}:</strong> ${n.message}
                    <span style="float:right; color:#9CA3AF;">${date}</span>
                </li>`;
        });
    }

    // Auto-refresh every 30 seconds
    setInterval(loadNotifications, 30000);
    document.addEventListener('DOMContentLoaded', loadNotifications);
</script>


<script>
        function confirmLogout() {
        closeModal();
        tlinkyToast('Logging out, see you soon 👋');
        setTimeout(() => {
            window.location.href = '/Login/Logout';
        }, 1000);
    }

</script>


